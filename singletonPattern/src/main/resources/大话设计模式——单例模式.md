# 大话设计模式——单例模式

## 是什么

是23种设计模式的一种,主要是为了在整个应用生命周期类只获得该类的单个实利.

## UML图

![img](https://img-blog.csdn.net/20141005003523312?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGh5X3ljdQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center)

## 实现过程

[代码下载](https://github.com/JerryDtj/designPattern/tree/master/singletonPattern)

- 线程不安全

  - 饱汉(懒汉)式
    1. 声明该类的私有构造方法
    2. 声明私有的类变量引用自身
    3. 声明一个公有的获取方法,如果为空那么返回一个新建的自身对象.如果不为空,直接返回.
  - 饥汉式
    1. 声明该类的私有构造方法
    2. 声明静态私有的类变量指向自身
    3. 声明一个静态公有的获取方法返回该类变量

- 线程安全:

  - 懒汉模式(双重锁定)
    1. 声明该类的私有构造方法
    2. 声明静态线程间可见的私有的类变量引用自身
    3. 声明一个静态公有的获取方法,.如果不为空,直接返回;如果为空那么锁定该类,在锁定块内继续判断该类是否为空,如果为空,返回一个新建的该类的对象
  - 懒汉模式升级版(静态内部类)
    1. 声明一个静态内部类SingletonFactory,在静态内部类中声明一个静态私有的外部类实例.
    2. 声明一个私有的构造方法,在构造方法内判断静态内部类的实例是否null,如果不为null,直接抛出异常(防止通过反射破坏单利)
    3. 声明一个静态公有获得方法,返回静态内部类的实例.

  # 优点与不足

- 优点
  - 用静态内部类模式,保留了饥汉模式线程间安全的特性,也保留了懒汉模式不用时不需要创建对象的特点.
  - 在内存里只有一个实例，减少了内存的开销，尤其是频繁的创建和销毁实例（比如管理学院首页页面缓存）。 
  - 避免对资源的多重占用（比如写文件操作）。
- 缺点
  - 没有接口，不能继承，与单一职责原则冲突，一个类应该只关心内部逻辑，而不关心外面怎么样来实例化。